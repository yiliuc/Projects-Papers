---
title: "***Are we living in a bicycle-friendly society? Still a long way to go!***"
author: "*Teams 25: Yiliu Cao, Yuxin Xu*"
output: pdf_document
date: "*November 18, 2022*"
fontsize: 12pt
header-includes:
  - \usepackage{titling}
  - \pretitle{\begin{flushleft}\LARGE}
  - \posttitle{\end{flushleft}\LARGE}
  - \preauthor{\begin{flushleft}}
  - \postauthor{\end{flushleft}}
  - \predate{\begin{flushleft}}
  - \postdate{\end{flushleft}}
---
```{r, include = FALSE}
library(tidyverse)
library(ggplot2)
library(scales)
```

```{r, include = FALSE}
data1 <- read.csv("Bicycle_Thefts.csv") # The bicycle thefts report in our community
data2 <- read.csv("Neighbourhood_Crime_Rates.csv") # The Population and Crime rates in each neighborhood
data3 <- read.csv("bicycle-thefts-2014-2019.csv") # The given data set
data4 <- read.csv("Canadian Household Spending (2010-2019).csv") # The average Canadian Spending
data5 <- read.csv("Canada_per_capita_income_from_1976_2019.csv") # The Canada per capita income in each state
data6 <- read.csv("FPCPITOTLZGCAN.csv") # The inflation Rate in Canada
data7 <- read.csv("LRUNTTTTCAM156S.csv") # The unemployment rate in Canada
data8 <- read.csv("wellbeing_toronto.csv") # The wellbeing data of Toronto in each community, including 
```

## Introduction

Nowadays, increasing numbers of people choose to ride bicycles as a mode of public transport in our communities. However, are we really in a bicycle-friendly society? Bicycle-friendly means that society is friendly to cyclists, and people feel comfortable traveling by bicycle [10]. The answer is probably NO, as bicycle thefts are becoming more noticeable and common in our community. In this article, we will uncover and share the patterns of bicycle thefts in our community and the potential reasons and solutions. 

## General Trends

From what Sheraya [1] suggested, the percentage of residents cycling in Toronto has doubled in the past two decades. We think more residents riding bicycle thefts may lead to increasing bicycle thefts as there are more bicycles. However, we did not find such a trend, and the general direction differs from what we expected. 

```{r, echo = FALSE, fig.width = 7, fig.height = 3.7}
figure1 <- data1 %>% 
  filter(Occurrence_Year >= 2014) %>% 
  mutate(Recover = case_when(Status == "RECOVERED" ~ "Recovered",
                             TRUE ~ "Not recovered"))

mean_bicycle <- mean((figure1 %>% group_by(Occurrence_Year) %>% summarise(n = n()))$n)

figure1$Recover <- factor(figure1$Recover, levels = c("Recovered", "Not recovered"))
figure1 %>% 
  ggplot(aes(x = as.character(Occurrence_Year))) +
  geom_bar(stat = "count",
           aes(fill = Recover),
           position = position_stack()) +
  scale_fill_manual("The status of stolen bicycles",
                    breaks = c("Recovered", "Not recovered"),
                    values=c("#E69F00", "#204e4c")) +
  geom_hline(aes(yintercept = round(mean_bicycle, 0),
                 linetype = "Average Bicycle Thefts"),
             colour = "grey",
             size = 1) +
  scale_linetype_manual("",
                        values = c("Average Bicycle Thefts" = "dashed")) +
  labs(title = "Figure 1: How number of bicycle thefts changed yearly?",
       subtitle = "Data source: Public Safety Data Portal [2]",
       x = "Year",
       y = "Number of bicycle thefts") +
  theme_bw()
```
Figure 1 shows the number of bicycle thefts in Toronto from 2014 to 2022 based on the data from Toronto Police Service Public Safety Data Portal [2]. Except for the year 2022, we can observe that the number of bicycle thefts increased gradually from 2014 (around 3000) to 2018, reaching a peak of about 4000 reports in 2018. Then the number of bicycle thefts fluctuated around 3800 for two years and decreased to about 3000 in 2021. Besides, 2016 to 2020 seem to be the most frequent years for bicycle thefts, which are all above the average number of bicycle thefts.\
Also, we can observe that the number of bicycles recovered after they were stolen is small. This means that if a cyclist’s bike is stolen, it is highly possible that he can never find his bicycle back.\
Furthermore, we also want to find bicycle thefts across different months. We think the weather is an essential factor for residents to choose to cycle or not, and the more people riding a bicycle, the higher the possibility of bicycle thefts. Luckily, what the data shows matches what we predicted. The summertime indeed has higher bicycle stolen reports than the rest months. 

```{r, echo = FALSE}
mean_month <- mean((data1 %>% filter(Occurrence_Year >= 2019) %>% group_by(Occurrence_Year) %>% summarise(n = n()/12))$n)

data1 %>% 
  mutate(Occurrence_Month = factor(Occurrence_Month, levels = month.name)) %>% 
  filter(Occurrence_Year >= 2019) %>% 
  ggplot(aes(x = Occurrence_Month)) +
  geom_line(stat = "count",
            aes(group = as.character(Occurrence_Year),
                colour = as.character(Occurrence_Year)),
            size = 1) +
  geom_point(stat = "count",
            aes(group = as.character(Occurrence_Year),
                colour = as.character(Occurrence_Year))) +
  scale_colour_manual(name = "Different years", 
                      values = c("grey", "black", "green", "red")) +
  geom_hline(aes(yintercept = round(mean_month, 0),
                 linetype = "Average Bicycle Thefts"),
             colour = "sky blue",
             size = 1) +
  scale_linetype_manual("",
                        values = c("Average Bicycle Thefts" = "dashed")) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = -60, hjust = 0, vjust = 1)) +
  labs(title = "Figure 2: How number of bicycle thefts changed monthly?",
       subtitle = "Data source: Public Safety Data Portal [2]",
       x = "Month",
       y = "Number of bicycle thefts")
```
Using the same data [2], we can find out from figure 2that most bicycle thefts happen during the summertime (June to September) every year. Also, the bicycle thefts that occurred during the winter months (November to March) were all under the average bicycle thefts of the four years. It is exciting to see that the number of bicycle thefts in the first half of 2022 is lower than previous years, we can expect that there will be less thefts in 2022.

## Patterns and risk assessment of bicycle thefts

In the first part, we investigated our community’s general trends of bicycle thefts yearly and monthly. We find an interesting pattern that summer seems to be the peak of bicycle thefts every year. Now, we can go further to see more patterns of bicycle thefts in terms of neighborhoods instead of the whole community.\
Oliveira [3] argues that the higher population leads to a superliner growth in crime rate because the high population increases the opportunity for interaction. Since a high population would lead to more crimes, it is reasonable to say that it will also increase the number of bicycle thefts. Also, “outside,” such as the street, seems to be the place that may have the most “interactions,” and hence outside seems to be the place where has the most thefts. While we again use the data from Toronto Police Service Public Safety Data Portal [2], we find such a pattern of premises type but not for the population.

```{r, echo = FALSE, fig.width = 8, fig.height = 6}
a <- (data1 %>% 
  group_by(NeighbourhoodName) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)))[c(1:10),]

l <- a$NeighbourhoodName

b <- data1 %>% 
  filter(NeighbourhoodName %in% l) %>% 
  mutate(new_premise = case_when(Premises_Type == "Outside" ~ "Outside",
                                 Premises_Type == "Apartment" ~ "Apartment",
                                 Premises_Type == "Educational" ~ "Educational",
                                 Premises_Type == "House" ~ "House",
                                 TRUE ~ "Others"))

pop_cri <- data2 %>% 
  filter(HoodName %in% l)

pop_cri$NeighbourhoodName <- pop_cri$HoodName


b$NeighbourhoodName <- factor(b$NeighbourhoodName, levels = l)
pop_cri$NeighbourhoodName <- factor(pop_cri$HoodName, levels = l)

mean_premise <- mean((data1 %>% group_by(Premises_Type) %>% summarise(n = n()/7))$n)

b$new_premise <- factor(b$new_premise, levels = c("Outside", "Apartment", "House", "Educational"))

ggplot(data = b %>% filter(new_premise != "Others"), aes(x = NeighbourhoodName)) +
  geom_bar(stat = "count",
           aes(fill = new_premise),
           position = "dodge") +
  geom_hline(aes(yintercept = round(mean_premise, 0),
                 colour = "Average bicycle thefts (Premise Type)"),
             linetype = 2,
             size = 1) +
  geom_line(data = pop_cri,
            stat = "identity",
            aes(y = F2021_Population_Projection/80,
                colour = "Population"),
            group = 1,
            size = 1) +
  geom_point(data = pop_cri,
            aes(y = F2021_Population_Projection/80,
                colour = "Population")) +
  labs(x = "Neighbourhoods",
       y =  "Number of bicycles thefts",
       title = "Figure 3: How premises types change in top 10 neighbourhoods with most\n bicycle thefts?",
       subtitle = "Data source: Toronto Public Safety Data Portal [2][8]") +
  theme_bw() +
  scale_colour_manual("",
                      values = c("Population" = "grey", "Average bicycle thefts (Premise Type)" = "black")) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 25)) +
  scale_y_continuous(name = "The count of bicycle thefts",
                     sec.axis = sec_axis(~.*80, name = "Population")) +
  scale_fill_manual("Premise Types",
                    values = c("#E69F00", "#56B4E9", "#009E73", "#F0E442")) +
  theme(axis.text.x = element_text(angle = -45, hjust = 0, vjust = 1))
```
Figure 3 shows the top 10 neighborhoods with the most bicycle thefts (from high to low). Notice that the premises type in bicycle thefts is the last parked bicycle place.  Even though the Waterfront Communities-The Island has the most residents (below 100000) and the highest number of bicycle thefts, we do not observe a clear trend of the population for the rest of the neighborhoods. For example, even though Dovercourt-Wallace Emerson-Junction has lower bicycle thefts, it has more people than Bay Street Corridor. Therefore, it is ambiguous to find the relationship between bicycle thefts and the population in a neighborhood.\
Regarding premises types, the number of bicycles that had been stolen on the outside is enormous among all neighborhoods except Niagara and University. We even see that the number of bikes stolen outside for the top three neighborhoods is about 1.5 times higher than the average (around 1000).\
Since there is no clear relationship between bicycle thefts and neighborhood population, is it possible that low-income people may steal bikes to have more money? And what about the relationship between bicycle thefts and low-income population and average income? 

```{r,echo = FALSE}
pop_count <- data1 %>% 
  group_by(NeighbourhoodName) %>% 
  summarise(Count = n())

population <- c()
for (i in 1:nrow(pop_count)){
  if (pop_count$NeighbourhoodName[i] %in% data2$HoodName){
    population[i] <- (data2 %>% 
      filter(HoodName == pop_count$NeighbourhoodName[i]))[1,4]
  }
  else{
    population[i] <- 0
  }
}

income <- c()
for (i in 1:nrow(pop_count)){
  if (pop_count$NeighbourhoodName[i] %in% data8$Neighbourhood){
    income[i] <- (data8 %>% 
      filter(Neighbourhood == pop_count$NeighbourhoodName[i]))[1,7]
  }
  else{
    income[i] <- 0
  }
}

low_income <- c()
for (i in 1:nrow(pop_count)){
  if (pop_count$NeighbourhoodName[i] %in% data8$Neighbourhood){
    low_income[i] <- (data8 %>% 
      filter(Neighbourhood == pop_count$NeighbourhoodName[i]))[1,6]
  }
  else{
    low_income[i] <- 0
  }
}

pop_count <- pop_count %>% 
  mutate(Population = population,
         After_tax = income,
         low_in_pop = low_income,
         new_after_tax = case_when(After_tax >= 71075.2 ~ "Top 10% neighbourhoods",
                                   After_tax < 71075.2 ~ "Bottom 90% neighbourhoods")) %>% 
  filter(Count != 0 & Population != 0 & After_tax != 0 & low_in_pop != 0)
```

```{r, echo = FALSE}
pop_count %>% 
  ggplot() +
  geom_point(aes(x = low_in_pop, 
                 y = Count,
                 colour = new_after_tax)) +
  scale_colour_manual("The rank of after-tax income\n of neighbourhoods",
                      values = c("red", "blue")) +
  labs(title = "Figure 4: Is the number of bicycle thefts closely related to the low-income \n population in each neighbourhood?",
       subtitle = "Data source: Wellbeing Toronto [4]",
       x = "Low-income population in each neighbourhood",
       y = "The number of bicycle thefts") +
  theme_bw()
```

By the data we collect from wellbeing Toronto [4]. We divide the neighborhoods into two groups, the neighborhoods with a top 10% average household income (relatively wealthy) and the bottom 90% (relatively poor). From looking at the low-income people in Toronto communities, the neighborhoods ranking top 10% in after-tax income levels have a relatively low number of bicycle thefts (below 500 a year).\
However, we can also observe that some communities with more low-income populations and low average incomes have less bicycle theft than those in wealthier neighborhoods. There indeed have some outliers of bicycle thefts which all refer to the poorer areas, but it is not enough to conclude poorer or more low-income neighborhoods have more bicycle thefts than those wealthier ones.


## Bike features

In previous parts, we show the trends and patterns of bicycle thefts. Now we wonder whether the bicycle is stolen depending on the bike’s features such as colors, prices, etc.\
However, we think the occurrence of bicycle thefts is random and unrelated to the bike itself. Thieves will steal bicycles when the time is right. Therefore, we expect there is no relationship between bike features and bicycle thefts. Surprisingly, what we found from the given data confirms our conjectures. There are no such patterns of bike features and thefts.

```{r, echo = FALSE}
a2 <- data3 %>% 
  group_by(Bike_Type) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

l2 <- a2[c(1:10),]$Bike_Type

c <- data3 %>% 
  filter(Bike_Type %in% l2) %>% 
  mutate(new_colour = case_when(Bike_Colour == "BLK   " ~ "Black",
                                Bike_Colour == "BLU   " ~ "Blue",
                                Bike_Colour == "GRY   " ~ "Grey",
                                TRUE ~ "Other colours"))


d <- (na.omit(data3) %>% 
  group_by(Bike_Type) %>% 
  summarise(n = n(),
            average_price = mean(Cost_of_Bike)) %>% 
  arrange(desc(n)))[c(1:10),]

c$new_colour <- factor(c$new_colour, levels = c("Other colours", "Blue", "Grey", "Black"))


d$Bike_Type <- factor(d$Bike_Type, levels = l2)

c$Bike_Type <- factor(c$Bike_Type, levels = l2)

ggplot() +
  geom_bar(data = c,
           stat = "count",
           aes(x = Bike_Type,
               fill = new_colour)) +
  scale_fill_manual("Premises Types",
                    values=c("#009E73", "sky blue", "dark grey", "black")) +
  geom_line(data = d,
            aes(x = Bike_Type,
                y = average_price*3,
                colour = "Average Price"),
            size = 1,
            group = 1) +
  scale_y_continuous(name = "The count of bicycle thefts",
                     sec.axis = sec_axis(~.*1/3, name = "Average price")) +
  scale_colour_manual("",
                      values = c("red")) +
  theme_bw() +
  labs(title = "Figure 5: How does the different colours contribute in each bike type?",
       subtitle = "Data Source: The given data",
       x = "Bike Types")
```

Figure 5 shows us the top 10 bike types with the most thefts and the colors and average of each type. We can see that even mountain bicycles (MT) and regular bicycles (RG) were stolen most frequently (around 6000) over the years; their average prices are in the middle-bottom range, which is about $600. At the same time, electric bicycles (EL) and scooter bicycles (SC) have a relatively high average price which is about $1700, but their number of bicycle thefts is only one-sixth of the mountains (MT) or regular (RG) bicycles.\
Furthermore, we cannot observe a clear pattern in bicycle colors to the number of thefts. It seems that bicycle colors have little impact on thefts of bicycles since the proportions of each color in each bike type are approximately the same. About one-third of bicycle thefts in each bike type are black, and one-fifth are blue or grey.\
When discussing risk factors, we do not find many patterns that bicycle thefts follow. In terms of population, we already show that the size of the population or low-income population does not play a role in investigating bicycle thefts. For bike features, we also conclude that the occurrence of bicycle thefts is random. However, the only two patterns we find that can help us avoid bicycle theft is that cyclists need to pay more attention to their bicycles when they ride in summer. Parking bicycles outsides is highly possible to be stolen. Therefore, we can advise cyclists always to pay attention to their bikes, not take any chances, and believe their bicycles will not be stolen.

## Potential reasons

In previous parts, we already show different information about bicycle thefts. However, it is necessary to find out why our community has so many bicycle thefts.\
People may steal bicycles as they are “poorer” and need more money. With this insight in mind, people are poor probably because their expenditure is much higher than their income and change in some economic factors which may increase living cost, such as inflation rates. Surprisingly, we find that people getting “poorer” may help us explain bicycle thefts. 

```{r, echo = FALSE}
spending <- data4[,c(1:7)]
Shelter <- c("15,020", "15,215", "15,807", "16,361", "17,160", "17,509", "18,032", "18,640", "19420", "20,200")
income <- data5 %>% 
  filter(REF_DATE <= 2019 & REF_DATE >= 2010 & GEO == "Ontario") %>% 
  select(REF_DATE, 
         GEO, 
         Average.income..excluding.zeros.) %>% 
  mutate(Shelter = as.numeric(gsub(",", "", Shelter)),
         Total_income = Average.income..excluding.zeros. + Shelter)

year <- c()
for (i in 1:length(data6$DATE)){
  split <- str_split_fixed(data6$DATE[i], "-", 3)
  year[i] <- split[1, 1]
}

inflation <- data6 %>% 
  mutate(Year = year,
         Inflation_rate = FPCPITOTLZGCAN) %>% 
  select(Year, Inflation_rate) %>% 
  filter(Year <= 2019)

year <- c()
for (i in 1:length(data7$DATE)){
  split <- str_split_fixed(data6$DATE[i], "-", 3)
  year[i] <- split[1, 1]
}

unemployment <- data7 %>% 
  mutate(Year = year,
         Unemployment_rate = LRUNTTTTCAM156S) %>% 
  select(Year, Unemployment_rate)
```

```{r, echo = FALSE}
ggplot() +
  geom_line(data = spending,
            aes(x = as.character(Year),
                y = as.numeric(gsub(",", "", Total.expenditure)),
                colour = "Expenditure"),
            group = 1,
            size = 1) +
  geom_line(data = income,
            aes(x = as.character(REF_DATE),
                y = Average.income..excluding.zeros.,
                colour = "Income without accommodations"),
            group = 1,
            size = 1) +
  geom_line(data = income,
            aes(x = as.character(REF_DATE),
                y = Total_income,
                colour = "Income with accommodations"),
            group = 1,
            size = 1) +
  geom_line(data = inflation,
            aes(x = Year,
                y = Inflation_rate*8000,
                colour = "Inflation Rate"),
            group = 1,
            size = 1) +
  geom_line(data = unemployment,
            aes(x = Year,
                y = Unemployment_rate*8000,
                colour = "Unemployment Rate"),
            group = 1,
            size = 1) +
  scale_y_continuous(name = "Expenditure and income",
                     sec.axis = sec_axis(~.*1/8000, name = "Inflation and Unemployment Rate (%)")) +
  scale_colour_manual("Potential Reasons",
                      values = c("blue", "grey", "black", "red", "Yellow")) +
  labs(title = "Figure 6: What can potentially influence the bicycle thefts?",
       subtitle = "Data source: Varity data [5][6][7][9]",
       x = "Year") +
  theme_bw()
```
For figure 6, I use variety of data set [5][6][7][9]. We can see that the amount of expenditure increases yearly. Even though the people’s income with or without accommodations also increases, the rise in expenditure is “faster” than the increase in income. From 2010 to 2019, the income with accommodation increased from about $60000 to about $70000, whereas the total expenditure increased from below $75000 to $95000. The increase in income is not enough for people to afford the living costs.\
Besides, we found that the inflation rate increased to about 2.5%, which is the highest one from 2014 to 2019. It seems that the inflation rate is an essential factor because we see from figure 1 that there is the highest amount of bicycle thefts in 2018. 

## Impact on different people

From previous parts, we already see that bicycle theft in our community is severe and can have different impacts on different people.\
For the people who lose their bikes, this is a violation of their property, and they lose their money. If the deliverer loses his bicycle, it will also impact his earnings. Furthermore, increasing bicycle thefts could also make the residents living in this area feel unsafe. For example, from figure 3, we know that the neighborhood of the University has a relatively high premises type of educational. Students may feel scared and not willing to cycle to the campus.

## Limitations

Although we have uncovered a variety of information about bicycle thefts in Toronto, there are still some limitations on our investigations.\
Firstly, there might be other factors that affect the number of bicycle thefts, such as the impact of Covid, or more people are aware of the sustainable environment. We didn’t conclude these factors in our analysis. For example, the information of bicycle thefts from Toronto Police Service Public Safety Data Portal is from 2014 to 2022. Therefore, the possible reasons for bicycle thefts we conclude may not be appropriate for 2020 to 2022 and this is highly possible as the impact of COVID.\
Secondly, the time span of data we have is limited.  When we want to find the potential reasons of bicycle thefts, we can only find the data (i.e., expenditure and income etc.) before 2020. This may make our investigation less convincing, for example, 2011 has the highest inflation and 2011 may have the highest number of bicycle thefts. However, we do not have the data of bicycle thefts in 2011. 

## Conclusion

Through this analysis of bicycle thefts in Toronto from 2014 to 2022, we find that the most significant patterns of bicycle theft frequently occur during summer and especially on the premises type of outside. Besides, it seems that some social factors can also potentially influence bicycle thefts, like inflation rates. We may not live in a bicycle-friendly society yet and have a long way to go. But we have the potential to reach a bicycle-friendly society as we have already seen that the number of bicycle thefts in each month of i2022 decreases.


\newpage


## Reference 

1. Kalra, S. (2022, July 26). Toronto remains 'woefully behind' as a modern Cycling City. rabble.ca. Retrieved November 18, 2022, from https://rabble.ca/environment/toronto-remains-woefully-behind-as-a-modern-cycling-city/    

2. Bicycle thefts. Public Safety Data Portal. (n.d.). Retrieved November 18, 2022, from https://data.torontopolice.on.ca/datasets/bicycle-thefts/explore?location=43.700396%2C-79.429535%2C11.27 

3. Oliveira, M. (2021, December 1). More crime in cities? on the scaling laws of crime and the inadequacy of per capita rankings-a cross-country study - crime science. BioMed Central. Retrieved November 18, 2022, from https://crimesciencejournal.biomedcentral.com/articles/10.1186/s40163-021-00155-8#Sec5 

4. City of Toronto. (2021, March 16). Wellbeing toronto. City of Toronto. Retrieved November 18, 2022, from https://www.toronto.ca/city-government/data-research-maps/neighbourhoods-communities/wellbeing-toronto/ 

5. Luan, C. (2022, January 13). Canada National &amp; Provincial per capita income. Kaggle. Retrieved November 18, 2022, from https://www.kaggle.com/datasets/charlesluan/canada-national-provincial-capita-income-762019 

6. Inflation, consumer prices for Canada. FRED. (2022, May 3). Retrieved November 18, 2022, from https://fred.stlouisfed.org/series/FPCPITOTLZGCAN 

7. Unemployment rate: Aged 15 and over: All persons for Canada. FRED. (2022, November 14). Retrieved November 18, 2022, from https://fred.stlouisfed.org/series/LRUNTTTTCAM156S 

8. Neighbourhood crime rates. Public Safety Data Portal. (n.d.). Retrieved November 18, 2022, from https://data.torontopolice.on.ca/datasets/TorontoPS::neighbourhood-crime-rates-2/about 

9. JessicaY1122. (2022, April 22). Canadian average expenditure per household. Kaggle. Retrieved November 18, 2022, from https://www.kaggle.com/datasets/jessicay1122/canadian-average-expenditure-per-household?select=Canadian%2BHousehold%2BSpending%2B%282010-2019%29.csv 

10. Wikimedia Foundation. (2022, August 3). Bicycle-friendly. Wikipedia. Retrieved November 18, 2022, from https://en.wikipedia.org/wiki/Bicycle-friendly 